{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "UDP Endpoint Configuration",
  "description": "UDP通信エンドポイントの設定",
  "type": "object",
  "required": ["protocol", "name", "direction", "address", "port"],
  "properties": {
    "protocol": {
      "type": "string",
      "enum": ["udp"],
      "description": "プロトコルタイプ（UDP固定）"
    },
    "name": {
      "type": "string",
      "description": "エンドポイント名",
      "minLength": 1,
      "maxLength": 256,
      "examples": ["sensor_data", "actuator_cmd"]
    },
    "direction": {
      "type": "string",
      "enum": ["in", "out", "inout"],
      "description": "通信方向"
    },
    "address": {
      "type": "string",
      "description": "IPアドレス（IPv4またはIPv6）",
      "oneOf": [
        {
          "format": "ipv4",
          "examples": ["192.168.1.100", "127.0.0.1"]
        },
        {
          "format": "ipv6",
          "examples": ["::1", "fe80::1"]
        }
      ]
    },
    "port": {
      "type": "integer",
      "description": "ポート番号",
      "minimum": 1,
      "maximum": 65535,
      "examples": [8080, 9000]
    },
    "options": {
      "type": "object",
      "description": "オプション設定",
      "properties": {
        "buffer_size": {
          "type": "integer",
          "description": "受信バッファサイズ（バイト）",
          "minimum": 512,
          "maximum": 65536,
          "default": 8192
        },
        "timeout_ms": {
          "type": "integer",
          "description": "タイムアウト時間（ミリ秒）",
          "minimum": 0,
          "default": 1000
        },
        "blocking": {
          "type": "boolean",
          "description": "ブロッキングモード",
          "default": true
        },
        "reuse_address": {
          "type": "boolean",
          "description": "SO_REUSEADDRオプション",
          "default": true
        },
        "broadcast": {
          "type": "boolean",
          "description": "ブロードキャスト許可",
          "default": false
        },
        "multicast": {
          "type": "object",
          "description": "マルチキャスト設定",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "マルチキャスト有効化",
              "default": false
            },
            "group": {
              "type": "string",
              "format": "ipv4",
              "description": "マルチキャストグループアドレス",
              "examples": ["224.0.0.1", "239.255.255.250"]
            },
            "interface": {
              "type": "string",
              "format": "ipv4",
              "description": "送信インターフェースのIPアドレス",
              "default": "0.0.0.0"
            },
            "ttl": {
              "type": "integer",
              "description": "Time To Live",
              "minimum": 1,
              "maximum": 255,
              "default": 1
            }
          },
          "required": ["enabled"],
          "if": {
            "properties": {
              "enabled": {"const": true}
            }
          },
          "then": {
            "required": ["group"]
          }
        }
      }
    }
  }
}